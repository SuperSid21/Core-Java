package project;

import java.io.BufferedReader;
import java.sql.*;
import java.io.InputStreamReader;
import java.util.Scanner;
class Car
{

	BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
	int choice,id;
	String pick,drop,Name,Email,Mobile;
	double fare,total_distance,rate_per_kilometer;
	
	public void Pick_drop() throws Exception{
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter Your Source From the below List");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Andheri\t Borivali\tDadar\tBandra\tChurchgate");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		pick=br.readLine();
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter Your Destination From the below List");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Andheri\t Borivali\tDadar\tBandra\tChurchgate");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		drop=br.readLine();
		if(pick.equalsIgnoreCase("borivali") && drop.equalsIgnoreCase("Andheri") || pick.equalsIgnoreCase("Andheri") && drop.equalsIgnoreCase("borivali")) {
			total_distance=18.2;
		}
		else if(pick.equalsIgnoreCase("borivali") && drop.equalsIgnoreCase("bandra") || pick.equalsIgnoreCase("bandra") && drop.equalsIgnoreCase("borivali")) {
			total_distance=26.2;
		}
		else if(pick.equalsIgnoreCase("borivali") && drop.equalsIgnoreCase("dadar") || pick.equalsIgnoreCase("dadar") && drop.equalsIgnoreCase("borivali")) {
			total_distance=31.3;
		}
		
		else if(pick.equalsIgnoreCase("borivali") && drop.equalsIgnoreCase("Churchgate") || pick.equalsIgnoreCase("churchgate") && drop.equalsIgnoreCase("borivali")) {
			total_distance=41.6;
		}
		else if(pick.equalsIgnoreCase("Andheri") && drop.equalsIgnoreCase("bandra") || pick.equalsIgnoreCase("bandra") && drop.equalsIgnoreCase("Andheri")) {
			total_distance=12.3;
		}
		else if(pick.equalsIgnoreCase("Andheri") && drop.equalsIgnoreCase("dadar") || pick.equalsIgnoreCase("dadar") && drop.equalsIgnoreCase("andheri")) {
			total_distance=26.2;
		}
			
		else if(pick.equalsIgnoreCase("Andheri") && drop.equalsIgnoreCase("churchgate") || pick.equalsIgnoreCase("churchgate") && drop.equalsIgnoreCase("andheri")) {
			total_distance=27.7;
		}
		else if(pick.equalsIgnoreCase("bandra") && drop.equalsIgnoreCase("dadar") || pick.equalsIgnoreCase("dadar") && drop.equalsIgnoreCase("bandra")) {
			total_distance=7.6;
		}
		else if(pick.equalsIgnoreCase("bandra") && drop.equalsIgnoreCase("churchgate") || pick.equalsIgnoreCase("churchgate") && drop.equalsIgnoreCase("bandra")) {
			total_distance=18.5;
		}
		else if(pick.equalsIgnoreCase("dadar") && drop.equalsIgnoreCase("Churchgate") || pick.equalsIgnoreCase("churchgate") && drop.equalsIgnoreCase("dadar")) {
			total_distance=11.3;
		}
		
		else if(pick.equalsIgnoreCase(drop)) {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Same Station \n Enter Correct Pick and drop place");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			Pick_drop();
		}
		else {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Enter Correct Pick and drop place");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			Pick_drop();
		}
	}
	
	
	public void Airport_transport()throws Exception
	{
		System.out.println("Enter Your Source From the below List");
		System.out.println("Andheri\tBorivali\tDadar\tBandra\tChurchgate");
		pick=br.readLine();
		drop="Andheri Airport";
		 if(pick.equalsIgnoreCase("borivali")) {
			total_distance=19.1;
		}
		 else if(pick.equalsIgnoreCase("Andheri")) {
				total_distance=3.3;
			}
		 else if(pick.equalsIgnoreCase("bandra")) {
				total_distance=15.1;
			}
		 else if(pick.equalsIgnoreCase("dadar")) {
				total_distance=15.9;
			}
		 else if(pick.equalsIgnoreCase("churchgate")) {
				total_distance=25.7;
			}
		 else {
			 System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("Enter Correct Pick place");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				Airport_transport();
			}
		Popular_car_types();
	}
	public void Local_station()throws Exception
	{
		Pick_drop();
		Popular_car_types();
	}
	public void Popular_car_types()throws Exception
	{
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Choice Car Type:\n1.suv\n2.Minivan\n3.sedan\n4.Exit");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		choice=Integer.parseInt(br.readLine());
		switch(choice){
		case (1):
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("SUV");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("4 Seats in the Car");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Choice Car Company:\n1.Bmw\n2.Maruti Suzuki\n3.Honda\n4.Exit");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			choice=Integer.parseInt(br.readLine());
			switch(choice){
			
			case(1):
					rate_per_kilometer=100;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of BMW:Per Kilo-Meter is RS.100");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(2):
					rate_per_kilometer=70;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of Maruti Suzuki:Per Kilo-Meter is RS.70");
					fare=total_distance*rate_per_kilometer;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(3):
					rate_per_kilometer=85;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of Honda:Per Kilo-Meter is RS.85");
					fare=total_distance*rate_per_kilometer;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			}
			
			
			break;
		case (2):
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Minivan");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("7 Seats in the Car");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Choice Car Company:\n1.Bmw\n2.Maruti Suzuki\n3.Honda\n4.Exit");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			choice=Integer.parseInt(br.readLine());
			switch(choice){
			
			case(1):
					rate_per_kilometer=120;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of BMW:Per Kilo-Meter is RS.120");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(2):
					rate_per_kilometer=85;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of Maruti Suzuki:Per Kilo-Meter is RS.85");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(3):
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					rate_per_kilometer=100;
					System.out.println("Price of Honda:Per Kilo-Meter is RS.100");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			}
			break;
		case (3):
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Sedan");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("4 Seats in the Car");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Choice Car Company:\n1.Bmw\n2.Maruti Suzuki\n3.Honda\n4.Exit");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			choice=Integer.parseInt(br.readLine());
			switch(choice){
			
			case(1):
					rate_per_kilometer=95;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of BMW:Per Kilo-Meter is RS.95");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(2):
					rate_per_kilometer=60;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of Maruti Suzuki:Per Kilo-Meter is RS.60");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			case(3):
					rate_per_kilometer=70;
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Price of Honda:Per Kilo-Meter is RS.70");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					fare=total_distance*rate_per_kilometer;
					System.out.println("Your car Total fare is "+fare);
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					break;
			}
			break;
		
	
		case(5):
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Thank you!");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			break;
		default:
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Invalid choice");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			break;
		}
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println(" Confirm to Book a Car");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("1.BOOK  2. Cancel");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		choice=Integer.parseInt(br.readLine());
		if(choice==1) {
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection conn=DriverManager.getConnection("jdbc:mysql://localhost:3306/car","root","");
			String s="select *from signin where name='"+Name+"'and mobile='"+Mobile+"';";
			PreparedStatement psmt=conn.prepareStatement(s);
			ResultSet rs=psmt.executeQuery();
		while(rs.next()) {
			id=rs.getInt("id");
			Email=rs.getString("email");
			String d="insert into save values('"+id+"','"+Name+"','"+Email+"','"+Mobile+"','"+pick+"','"+drop+"','"+fare+"')";
			PreparedStatement psmt1=conn.prepareStatement(d);
			int row=psmt1.executeUpdate();{
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("your car is booked now.\n Get ready in 10 Min");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			}
		}
		
		}
		catch(Exception e) {
		}
		}
		else {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Thank you");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		}
	}
	
	
	public void sign_up()throws Exception {
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter your name");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		Name=br.readLine();
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter your Email");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		Email=br.readLine();
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter your Mobile Number");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		Mobile=br.readLine();
		try {			
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection conn=DriverManager.getConnection("jdbc:mysql://localhost:3306/car","root","");
			String s="insert into signin (name,email,mobile) values('"+Name+"','"+Email+"','"+Mobile+"');";
			PreparedStatement psmt=conn.prepareStatement(s);
			int row=psmt.executeUpdate();
			if(row >0) {
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("sign up successfully");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("enter your name and mobile no. for log in");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				log_in();
			}
			else {
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("error");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			}
			
		}
		catch(Exception e) {
			
		}
	}
		public void log_in() throws Exception {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			System.out.println("Enter your name");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			Name=br.readLine();
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Enter your Mobile Number");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			Mobile=br.readLine();
			try {
				Class.forName("com.mysql.cj.jdbc.Driver");
				Connection conn=DriverManager.getConnection("jdbc:mysql://localhost:3306/car","root","");
				String s="select *from signin where name='"+Name+"'and mobile='"+Mobile+"';";
				PreparedStatement psmt=conn.prepareStatement(s);
				ResultSet rs=psmt.executeQuery();
			if(rs.next()) {
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				
				System.out.println("Enter your Choice:\n1.Airport Transport\n2.Local\n3.exit");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				
				choice=Integer.parseInt(br.readLine());
				if(choice==1){
					Airport_transport();
					
				}
				else if(choice==2){
					Local_station();
					
				}
				else if(choice==3){
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					
					System.out.println("Thank you");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					
				}
				else{
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Invalid choice");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					
				}
				}
			else {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				
			System.out.println("wrong username or password");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			System.out.println("Enter your Choice:\n1.Login\n2.Sign Up\n3.exit");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			choice=Integer.parseInt(br.readLine());
			if(choice==1) {
				log_in();
			}
			else if(choice==2){
				sign_up();
			}
			else if(choice==3) {
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					System.out.println("Thank you");
					System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
					
			}
			
			else {
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				System.out.println("invalid choice");
				System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
				
			}
			}
			}
			catch(Exception e) {
				
			}
		}
		public void History()throws Exception {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			System.out.println("Enter your name");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			Name=br.readLine();
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("Enter your Mobile Number");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			Mobile=br.readLine();
			try {
				Class.forName("com.mysql.cj.jdbc.Driver");
				Connection conn=DriverManager.getConnection("jdbc:mysql://localhost:3306/car","root","");
				String s="select *from save where name='"+Name+"'and mobile='"+Mobile+"';";
				PreparedStatement psmt=conn.prepareStatement(s);
				ResultSet rs=psmt.executeQuery();
				while(rs.next()) {
					System.out.println("####################################################################################################################################################################");
					System.out.println("Name :"+rs.getString("name"));
					System.out.println("Email :"+rs.getString("email"));
					System.out.println("Mobile No :"+rs.getString("mobile"));
					System.out.println("Pick Place:"+rs.getString("pick"));
					System.out.println("Drop Place:"+rs.getString("drop"));
					System.out.println("Fare :"+rs.getDouble("fare"));

					System.out.println("####################################################################################################################################################################");
					
				}
			}
			catch(Exception e) {
				
			}
		}
	
	public static void main(String args[])throws Exception
	{
		Scanner sc =new Scanner(System.in);
		int choice;
		
		System.out.println("=============================================================================================================================================================================");
		Thread.sleep(2000);
		System.out.print("Welcome ");
		
		Thread.sleep(2000);
		System.out.println("Mycar");
		System.out.println("=============================================================================================================================================================================");
		
		Thread.sleep(2000);
		Car c = new Car();
		
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		System.out.println("Enter your Choice:\n1.Login\n2.Sign Up\n3.History\n4.exit");
		System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		
		choice=sc.nextInt();
		if(choice==1) {
			c.log_in();
		}
		else if(choice==2){
			c.sign_up();
		}
		else if(choice==3) {
			c.History();
		}
		else if(choice==4) {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
			System.out.println("Thank you");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			
		}
		
		else {
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
			System.out.println("invalid choice");
			System.out.println("------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
	
			
		}
	
		
		}
}